<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>歐欸利恩的部落格</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="歐欸利恩的部落格"><meta name="msapplication-TileImage" content="/images/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="歐欸利恩的部落格"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="歐欸利恩的部落格"><meta property="og:url" content="http://oalieno.github.io/"><meta property="og:site_name" content="歐欸利恩的部落格"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://oalieno.github.io/img/og_image.png"><meta property="article:author" content="oalieno"><meta property="article:tag" content="blog, security, programming, coding, life"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://oalieno.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://oalieno.github.io"},"headline":"歐欸利恩的部落格","image":["http://oalieno.github.io/img/og_image.png"],"author":{"@type":"Person","name":"oalieno"},"publisher":{"@type":"Organization","name":"歐欸利恩的部落格","logo":{"@type":"ImageObject","url":{"text":"歐欸利恩的部落格","img":"/images/logo.svg"}}},"description":""}</script><link rel="icon" href="/images/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&amp;family=Material+Icons&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-LYLB67MBLS" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-LYLB67MBLS');</script><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }
          Array
              .from(document.querySelectorAll('.tab-content'))
              .forEach($tab => {
                  $tab.classList.add('is-hidden');
              });
          Array
              .from(document.querySelectorAll('.tabs li'))
              .forEach($tab => {
                  $tab.classList.remove('is-active');
              });
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img nolazy src="/images/logo.svg" alt="歐欸利恩的部落格" height="28"><p>歐欸利恩的部落格</p></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">首頁</a><a class="navbar-item" href="/archives">文章</a><a class="navbar-item" href="/categories">分類</a><a class="navbar-item" href="/tags">標籤</a><a class="navbar-item" href="/about">關於我</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2023-10-28T16:00:00.000Z" title="10/29/2023, 12:00:00 AM">2023-10-29</time></span><i class="material-icons">schedule</i><span class="level-item">14 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">資安</a><span> / </span><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/%E9%9B%9C%E8%AB%87/">雜談</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/10/29/gashapon/">【Paper 解讀】打造公平的遊戲轉蛋：在不洩漏原始碼的前提下驗證虛擬轉蛋的機率</a></h1><div class="content"><p>這篇是 <a target="_blank" rel="noopener" href="https://hitcon.org/2023/CMT/agenda/1e5ff161-1857-4327-b3a5-c1b7892449d5/">HITCON CMT 2023 的演講</a><br>
今天就來解讀一下這篇在講什麼。我在現場聽的時候，被突如其來的數學打得頭昏眼花，事後看懂才寫了這篇xD</p>
<h1>背景</h1>
<p>丁特事件中，遊戲橘子公告的機率與實際上抽的機率不符合，但消費者又無法驗證，所以作者就想知道能不能設計出一個，可以在不開源的情況下驗證官方公告的機率是否為真的系統。以下是幾個重要事件的時間線。</p>
<ul>
<li>2021/06 → 轉蛋法聯署</li>
<li>2021/08 → 丁特事件</li>
<li>2023/01 → 轉蛋法生效，參考日本、韓國的轉蛋法</li>
</ul>
<p>值得注意的是日本有限制保底抽數、金額。<br>
而大家在意的是怎麼<strong>驗證</strong>機率。</p>
<h1>Related Works</h1>
<p>這邊提到了兩篇 related works，但有一些各自的問題</p>
<ul>
<li><a href="gacha.gamelab.com.tw">gacha.gamelab.com.tw</a>
<ul>
<li>第三方驗證平台(壞掉了?)，玩家自行上傳抽獎紀錄</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://www.researchgate.net/publication/348794514_Bringing_transparency_and_trustworthiness_to_loot_boxes_with_blockchain_and_smart_contracts">(PDF) Bringing transparency and trustworthiness to loot boxes with blockchain and smart contracts (researchgate.net)</a>
<ul>
<li>嘗試用 smart contract 來解決這個問題，但是這樣就是 open source 了</li>
<li>而且在 smart contract 上還有 random source 的問題</li>
</ul>
</li>
</ul>
<h1>怎麼做</h1>
<p>轉蛋主要由兩個部分組成，隨機來源 + 轉蛋函式。<br>
所以要可以驗證轉蛋的機率代表我們需要，<strong>可以驗證的</strong>隨機來源 + <strong>可以驗證的</strong>轉蛋函式</p>
<h2 id="Verifiable-Random-Source">Verifiable Random Source</h2>
<h3 id="簡單作法">簡單作法</h3>
<p align="center"><img data-src="/images/gashapon-00.png" class=" lazyload"  title="Verifiable Random Source 簡單作法"></p>
<p>所有人提供一個 random number，把大家的 xor 起來<br>
但是這樣做可能會有 Last Contribution Attack，也就是最後一個人 C 可以暴力的嘗試不同的 c 值，選一個可以中獎的，等於最後一個人可以操控結果</p>
<h3 id="HeadStart">HeadStart</h3>
<p align="center"><img data-src="/images/gashapon-01.png" class=" lazyload"  title="Verifiable Random Source HeadStart 作法"></p>
<p>所以這邊他們改良了前面的作法，這個作法叫做 <a target="_blank" rel="noopener" href="https://www.ndss-symposium.org/ndss-paper/auto-draft-184/">HeadStart</a>，這也是作者同一個實驗室他們發的論文。<br>
這個作法主要改動了兩個部分</p>
<ul>
<li>把大家的 random number 做成 Merkle Tree</li>
<li>最後會經過 Verifiable Delay Function (VDF) 的運算得到最後結果</li>
</ul>
<p>做成 Merkle Tree 的主要好處是，驗證只需要 O(logN) 的時間和空間</p>
<p align="center"><img data-src="/images/gashapon-02.png" class=" lazyload"  title="Merkle Tree"></p>
<p>VDF 則是一個需要一定的時間計算，但是可以被迅速驗證 (有點像是 Blockchain 的 POC，但是 VDF 不能被 parallelized)，因為計算需要一定的時間，所以就可以避免 Last Contribution Attack</p>
<h2 id="Verifiable-Function">Verifiable Function</h2>
<p>接著有了 Verifiable Random Source 之後，我們還需要 Verifiable Function。<br>
這邊作者直接採用了一種 Zero Knowledge Proof 叫做 <a target="_blank" rel="noopener" href="https://vitalik.ca/general/2019/09/22/plonk.html">PLONK</a>。原本我們的函式長這樣 f(x) = y，那加上這個 PLONK 之後，他就會多吐出一個 proof 讓我們驗證，f(x) = y + proof。這邊其實不需要理解數學的細節，總之可以在不公開函式的情況下驗證你是用同一個函式去算出 x 的結果 y，而不是我給你輸入你才又偷偷換了另一個每次都抽不到的函式。如果真的想了解的同學可以看一下 <a target="_blank" rel="noopener" href="https://medium.com/@VitalikButerin/quadratic-arithmetic-programs-from-zero-to-hero-f6d558cea649">Vitalik 大神的 ZKP 系列</a>。</p>
<h1>實際的流程</h1>
<p>前面介紹了必要的元件之後，我們就可以來看實際的抽卡流程是怎麼個樣子</p>
<h2 id="Probability-Verification-Protocol">Probability Verification Protocol</h2>
<p>今天我想測一下這個遊戲的機率是不是唬爛的，我就可以發起這個驗證的流程 (沒有真的抽卡，只是模擬抽卡)。<br>
可以想像函式 f 就是一個下面這樣的函式，吃兩個參數，random source r 和遊戲參數 o。<br>
遊戲參數裡面會有像是 VIP 等級、抽卡次數等，比如抽卡次數就很有用，可以根據抽獎次數計算要不要保底。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">loot</span>(<span class="params">seed, params</span>):</span><br><span class="line">    random.seed(seed)</span><br><span class="line">    num = random.randint(<span class="number">0</span>, <span class="number">999</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 20 抽保底</span></span><br><span class="line">    <span class="keyword">if</span> params[<span class="string">&quot;抽獎次數&quot;</span>] &gt;= <span class="number">19</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 機率 10%</span></span><br><span class="line">    <span class="keyword">if</span> num &lt; <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p align="center"><img data-src="/images/gashapon-03.png" class=" lazyload"  title="Probability Verification Protocol"></p>
<p align="center"><img data-src="/images/gashapon-04.png" class=" lazyload"  title="Probability Verification Protocol"></p>
<ol>
<li>首先，會有一個 Random Beacon 收集大家貢獻的 randomness，收集滿了之後，吐出 100 個 test data (模擬 100 次抽卡)
<ul>
<li>假設是 m = 100 的話 (方便想像)</li>
</ul>
</li>
<li>這些 test data 就會丟進去函式裡面運算，最後吐出 100 個 (抽卡結果, 證明)，這些都會放在公告欄裡面</li>
<li>最後，玩家們就可以拿 test data 和公佈欄裡面的 (抽卡結果, 證明) 去驗證函式 (透過 PLONK 的 ZKP 證明)</li>
<li>驗證正確代表函式沒有被動手腳，所以就可以直接來算算看這 100 個抽卡結果的中獎機率是多少啦
<ul>
<li>論文中還有計算說，如果官方說是 0.3 的機率，哪麼驗證出來的機率要小於多少就有很高機率他在說謊</li>
</ul>
</li>
</ol>
<h2 id="Loot-Box-Opening-Protocol">Loot Box Opening Protocol</h2>
<p>最後是真的要抽卡的時候的流程 (作者畫的圖好複雜，不貼了xD)</p>
<ul>
<li>Setup
<ul>
<li>(Server) 先算出一個 Hash Chain，然後把 <code>a_n</code> 給玩家
<ul>
<li><code>a_i = H(a_i-1)</code></li>
<li><code>a_0 -&gt; a_1 -&gt; a_2 -&gt; ... -&gt; a_n</code></li>
</ul>
</li>
</ul>
</li>
<li>以下步驟可以重複多次
<ul>
<li>Evaluation (開抽)
<ul>
<li>(Player) 隨機選一個 random 數 <code>B</code>，還有一些遊戲參數 <code>O</code> (比如 VIP 等級、抽獎次數等)，傳給 Server</li>
<li>(Server) 上次 Hash Chain 選到 <code>a_i</code>，這次就挑 <code>a_i-1</code>。 計算 random source 等於 <code>a_i-1 || B</code> (合併雙方的 random source)，帶入抽卡函式 <code>f(a_i-1 || B, O) = y + proof</code>。最後把結果 <code>(y, proof, a_i-1)</code> 傳回去給玩家</li>
</ul>
</li>
<li>Verification
<ul>
<li>(Player) 拿到 proof 可以驗證是同一個函式</li>
<li>(Player) 拿到 <code>a_i-1</code> 可以驗證 <code>H(a_i-1) = a_i</code> (代表 Server 不是隨心所欲的亂選一個隨機數而是在玩家選出 <code>B</code> 之前就已經決定好 <code>a_i-1</code> 了)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>這邊的重點其實是 Hash Chain 的部分，可以確保 Server 不是在收到玩家選的 random source <code>B</code> 之後，才挑一個抽不到卡的 random source。</p>
<h1>結論</h1>
<p>就是因為不想開源，所以才需要 ZKP，但仔細思考一下，其實 ZKP 的部分跟其他 Protocol 可以完全切開，ZKP 在這裡扮演的就是確保遊戲廠商至始至終都是用同一個函式，不會在模擬抽卡和真正抽卡的時候用不同的函式，這樣就可以用模擬抽卡來驗證機率了。把 ZKP 的部分去掉之後看，就會發現其實沒這麼複雜xD (不要上來就貼數學式RRR)</p>
<p>再來的問題就只是 Random Source 怎麼來</p>
<ul>
<li>模擬抽卡: 用 HeadStart 讓大家貢獻 Random Source</li>
<li>真的開抽: Server 和 Player 雙方各貢獻一個 Random Source，然後 Server 用 Hash Chain 來證明他在 Player 選 Random Source 之前就已經選好了，不是拿到 Player 的 Random Source 才挑的</li>
</ul>
<p>要開源的話，其實只要抽卡部分的程式碼可以開源就好了吧，這樣就完全不用 ZKP，實作就只剩 Hash Chain 那邊要實作，其他通通不需要了，模擬抽卡什麼的也不用了，都已經有 source code 看就知道機率是多少，要驗證函式的話，你只要把輸入丟進去看輸出是不是一樣的就好。</p>
<h1>References</h1>
<ul>
<li>他們的簡報: <a target="_blank" rel="noopener" href="https://hitcon.org/2023/CMT/slide/%E6%89%93%E9%80%A0%E5%85%AC%E5%B9%B3%E7%9A%84%E9%81%8A%E6%88%B2%E8%BD%89%E8%9B%8B_%E5%9C%A8%E4%B8%8D%E6%B4%A9%E6%BC%8F%E5%8E%9F%E5%A7%8B%E7%A2%BC%E7%9A%84%E5%89%8D%E6%8F%90%E4%B8%8B%E9%A9%97%E8%AD%89%E8%99%9B%E6%93%AC%E8%BD%89%E8%9B%8B%E7%9A%84%E6%A9%9F%E7%8E%87.pdf">打造公平的遊戲轉蛋_在不洩漏原始碼的前提下驗證虛擬轉蛋的機率.pdf</a></li>
<li>他們的論文: <a target="_blank" rel="noopener" href="https://tdr.lib.ntu.edu.tw/jspui/retrieve/7265a12d-07f3-4561-b163-84e3adb0168d/ntu-111-2.pdf">ntu-111-2.pdf</a></li>
<li>他們的原始碼: <a target="_blank" rel="noopener" href="https://github.com/WangJ509/LootBoxVerification">WangJ509/LootBoxVerification (github.com)</a></li>
</ul>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2023/10/29/gashapon/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2023-09-06T16:00:00.000Z" title="9/7/2023, 12:00:00 AM">2023-09-07</time></span><i class="material-icons">schedule</i><span class="level-item">2 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/Windows/">Windows</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/09/07/windows-facts-02/">【Windows 小知識】PE Section 大小</a></h1><div class="content"><p align="center"><img data-src="/images/PE-section.png" class=" lazyload"  title="PE Section in PE-Bear"></p>
<p>我們今天就來看這個 PE 的 Section 中 Raw Size 和 Virtual Size 的差別。<br>
你可能會發現說大部分 Raw Size 會比 Virtual Size 還要大，這是為什麼呢?</p>
<p>要理解這一點，我們要先理解 Alignment 的概念。<br>
每當系統在分配記憶體的時候，都需要進行 Alignment，確保記憶體位址是某個數值的倍數，這樣做不僅可以避免掉不少的麻煩，也讓記憶體管理變得更加簡單且直覺。</p>
<p>PE 的 Optional Header 中有定義兩種 Alignment</p>
<ul>
<li>File Alignment: Raw Size 對齊的大小，預設是 0x200</li>
<li>Section Alignment: Virtual Size 對齊大小，預設是 0x1000</li>
</ul>
<p>因此，回來看 Section 的大小會發現，PE 裡面寫的 Raw Size 其實是已經經過 File Alignment 處理過的大小，都是 0x200 的倍數。而 Virtual Size 是原始沒有進行 Section Alignment 處理的大小。</p>
<p>舉個上面那張圖的例子來看，程式跑起來的時候，<code>.rdata</code> 實際在記憶體中分配的大小是 <code>0x2000</code> (<code>0x1242</code> 進行 Section Alignment 對齊 0x1000 完的結果)，所以 .rdata 在記憶體的實際大小反而是比 Raw Size 大，而這些多出來的空間其實就是駭客最喜歡放 shellcode 的風水寶地啦xD</p>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2023/09/07/windows-facts-02/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2023-08-14T16:00:00.000Z" title="8/15/2023, 12:00:00 AM">2023-08-15</time></span><i class="material-icons">schedule</i><span class="level-item">5 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/Windows/">Windows</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/08/15/windows-facts-01/">【Windows 小知識】檔案總管的排序規則</a></h1><div class="content"><p>首先，先讓 ChatGPT 幫我開場一下，我覺得他腦補得好像還不錯xD</p>
<details class="admonition abstract" open><summary>ChatGPT 小故事時間</summary><p><p>曾經好奇過，當我們在 Windows 檔案總管中觀察文件列表時，是什麼魔法使它們按照這樣一個特定的順序排列的嗎？嗯，這就是我要告訴你的故事：一個叫做 <code>StrCmpLogicalW</code> 的神秘 Windows API 的故事。</p>
<p>想像一下，有一天，Windows 開發者們圍坐在一起，思考著如何讓檔案總管的排序更符合用戶的直覺。你看，當用戶看到 “img10.jpg” 和 “img2.jpg” 這兩個文件時，他們自然會認為 “img2.jpg” 應該在 “img10.jpg” 之前，即使從字母順序上看，“10” 確實是在 “2” 之前。但是，人們不是機器，我們的大腦認為 2 小於 10。這就是 Windows 開發者們需要解決的問題。</p>
<p>於是，<code>StrCmpLogicalW</code> 這個 API 應運而生。</p>
</p></details>
<p>我是某一天在找我的樣本的時候才發現這個神祕的排序<br>
因為樣本大多是用檔案的 hash 當作檔名，所以會長的像下面這樣</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1c8bb52633d0861e2137a984048bd224</span><br><span class="line">4adc8224eb736aa10e168390ac8cc251</span><br><span class="line">05ece5d005502c211d57c5028fcce17e</span><br><span class="line">7c30d3db6f1a28c08a21fbf1bccf771f</span><br><span class="line">9f6fc22fd9c97e68eda4e707e6200849</span><br><span class="line">29d0984f03fd2cce2f57b17005ab8e0e</span><br><span class="line">58f75d29b3675cadf8f4f25be1275838</span><br><span class="line">0524df255a48254e8a7a39a20d7328e3</span><br><span class="line">ae2219b53716336c3bb26f8a5ff693c0</span><br><span class="line">d4a0c7c5ff0e88f31167a91085539fdd</span><br><span class="line">d300c7c5ff0e88f31167a91085539fdd</span><br></pre></td></tr></table></figure>
<p>一般正常排序會用字典序(Lexicographic order)，所以第一個字母排起來應該要是 <code>0, 0, 1, 2, ...</code> 照順序排，但我們看到上面的例子，在檔案總管裡面，他是排成 <code>1, 4, 0, 7, ...</code> 這個奇怪的順序，到底在排什麼，我一開始注意到就是各種問號，後來查一查才發現他是用 <code>StrCmpLogicalW</code> 這個神祕的 Windows API 去比較兩個字串，<a target="_blank" rel="noopener" href="https://www.geoffchappell.com/studies/windows/shell/shlwapi/api/strings/strcmplogicalw.htm">這篇</a>有比較細節的去介紹其中的機制，比官方文件詳細。</p>
<p><code>StrCmpLogicalW</code> 在比較的時候是用 meta-character 當做單位，meta-character 有分三種</p>
<ul>
<li><code>.</code></li>
<li>數字</li>
<li>其他字元</li>
</ul>
<p>這三大類之間的排序是 <code>.</code> &lt; 數字 &lt; 其他字元，之後才是比較大類裡面的大小<br>
重點就是這裡的數字是把整串的數字當作一個數值在比較<br>
比如 <code>29d0</code> 就是把前面兩個數字當作 <code>29</code> 這個數值比較，所以 <code>9f6f</code> &lt; <code>29d0</code> (<code>9</code> &lt; <code>29</code>)<br>
之所以要這樣排，應該跟 ChatGPT 介紹得差不多，為了讓一般使用者看起來更直覺，像是 <code>img1.jpg</code>, <code>img2.jpg</code>, …, <code>img10.jpg</code> 就會照 <code>1, 2, 3, ...</code> 的順序排了，就不會因為用字典序排，所以變成先 <code>1, 10, 11, ...</code> 1 開頭的排完才換 2 的 <code>2, 20, 21, ...</code>，這種一般使用者比較不習慣的排法。</p>
<hr>
<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows/win32/api/shlwapi/nf-shlwapi-strcmplogicalw">https://learn.microsoft.com/en-us/windows/win32/api/shlwapi/nf-shlwapi-strcmplogicalw</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geoffchappell.com/studies/windows/shell/shlwapi/api/strings/strcmplogicalw.htm">https://www.geoffchappell.com/studies/windows/shell/shlwapi/api/strings/strcmplogicalw.htm</a></li>
</ul>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2023/08/15/windows-facts-01/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2023-03-01T16:00:00.000Z" title="3/2/2023, 12:00:00 AM">2023-03-02</time></span><i class="material-icons">schedule</i><span class="level-item">20 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/AI/">AI</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/02/bloom-zh/">【語言模型】繁中語言模型 bloom-1b1-zh 試玩</a></h1><div class="content"><blockquote>
<p>由聯發科（2454）集團轄下的前瞻技術研究單位聯發創新基地、中央研究院詞庫小組和國家教育研究院三方所組成的研究團隊，今日開放全球第一款繁體中文語言模型到開源網站提供測試。</p>
<p>來源: <a target="_blank" rel="noopener" href="https://udn.com/news/story/7240/6991226">https://udn.com/news/story/7240/6991226</a></p>
</blockquote>
<p>上禮拜聽說有新的繁體中文的語言模型釋出，想來玩一下，但是新聞上沒有放連結，找了一下才找到 <a target="_blank" rel="noopener" href="https://huggingface.co/ckip-joint/bloom-1b1-zh">bloom-1b1-zh</a>，但是這個模型只有 2GB，不是原本 Bloom 的 1760 億參數的那個模型，是迷你版的，雖然 1760 億參數的模型我的電腦也跑不動就是了xD</p>
<h2 id="安裝">安裝</h2>
<p>先來說一下怎麼安裝，首先開一個 python 的虛擬環境，看你要開 venv 還是用 poetry 或是 conda 都可以，建議是裝在虛擬環境不要直接裝在本地套件，我這邊示範是開一個 venv 來安裝</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -m venv .venv</span><br><span class="line">source .venv/bin/activate</span><br></pre></td></tr></table></figure>
<p>接著就安裝 <code>transformers</code> 和 <code>pytorch</code><br>
<code>pytorch</code> 可以去 <a target="_blank" rel="noopener" href="https://pytorch.org/get-started/locally/">pytorch 官網</a> 上複製安裝指令，根據你的 OS 還有你的 CUDA 版本選不同的安裝指令，我是選 Stable (1.13.1) 和 CUDA 11.7，然後用 pip 安裝</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install transformers</span><br><span class="line">pip install torch torchvision torchaudio --extra-index-url https://download.pytorch.org/whl/cu117</span><br></pre></td></tr></table></figure>
<p>裝完之後，接下來就是下載模型，直接把 <a target="_blank" rel="noopener" href="https://huggingface.co/ckip-joint/bloom-1b1-zh">bloom-1b1-zh</a> clone 下來，記得要裝 <a target="_blank" rel="noopener" href="https://docs.github.com/en/repositories/working-with-files/managing-large-files/installing-git-large-file-storage?platform=linux">git lfs</a>，或是你也可以手動載下來</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://huggingface.co/ckip-joint/bloom-1b1-zh</span><br></pre></td></tr></table></figure>
<p>載完之後執行以下腳本就可以開始玩了<br>
這個腳本先用 <code>from_pretrained</code> 從剛剛下載的資料夾 <code>./bloom-1b1-zh</code> 載入模型<code>下面我寫了一個 while 迴圈吃</code>使用者輸入<code>還有</code>輸出長度`，然後印出結果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> BloomForCausalLM</span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> BloomTokenizerFast</span><br><span class="line"></span><br><span class="line">model = BloomForCausalLM.from_pretrained(<span class="string">&quot;./bloom-1b1-zh&quot;</span>)</span><br><span class="line">tokenizer = BloomTokenizerFast.from_pretrained(<span class="string">&quot;./bloom-1b1-zh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">prompt, result_length</span>):</span><br><span class="line">    inputs = tokenizer(prompt, return_tensors=<span class="string">&quot;pt&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> tokenizer.decode(model.generate(inputs[<span class="string">&quot;input_ids&quot;</span>],</span><br><span class="line">                           max_length=result_length,</span><br><span class="line">                           num_beams=<span class="number">2</span>,</span><br><span class="line">                           no_repeat_ngram_size=<span class="number">2</span>,</span><br><span class="line">                           early_stopping=<span class="literal">True</span></span><br><span class="line">                          )[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    prompt = <span class="built_in">input</span>(<span class="string">&quot;prompt: &quot;</span>)</span><br><span class="line">    length = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;length: &quot;</span>))</span><br><span class="line">    result = gen(prompt, length)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>
<h2 id="實驗">實驗</h2>
<p>先隨便抓一些新聞的開頭來試一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">prompt: 金管會要出手了！詐騙集團手法層出不窮，黃天牧今（2）日透露，最快2周內、3月底前將跟臉書Meta與谷歌二家社群平台開會</span><br><span class="line">length: 300</span><br><span class="line"></span><br><span class="line">金管會要出手了！詐騙集團手法層出不窮，黃天牧今（2）日透露，最快2周內、3月底前將跟臉書Meta與谷歌二家社群平台開會，討論如何打擊詐欺集團。</span><br><span class="line">「黃大哥」表示，目前詐詐集團已從社群網站下手，但臉書的社群功能較弱，因此，他會與Google、Facebook等平台商討論，如何加強社群的防範功能，讓社群更安全。&lt;/s&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">prompt: 「這是希臘史上最嚴重的火車意外之一，也是歐債危機以來撙節開支的後遺症...」希臘當地時間2月28日午夜的火車對撞的嚴重事故，目前</span><br><span class="line">length: 100</span><br><span class="line"></span><br><span class="line">「這是希臘史上最嚴重的火車意外之一，也是歐債危機以來撙節開支的後遺症...」希臘當地時間2月28日午夜的火車對撞的嚴重事故，目前已經造成至少50人死亡，超過200人受傷。</span><br><span class="line">希臘總理帕潘德里歐在記者會中說，事故發生後，希臘政府已經下令，所有公共運輸系統，包括火車、巴士、地鐵、公車等，都必須關閉，直到救援工作完成為止。&lt;/s&gt;</span><br></pre></td></tr></table></figure>
<p>怎麼出現 <code>詐詐集團</code>，竟然疊字裝可愛?!<br>
看起來產生的文字還算通順，他還會自己加一個 <code>&lt;/s&gt;</code> 停止符號，代表他說完了</p>
<p>接下來嘗試讓他完成一些對話</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">prompt: 甲:「你好!」乙:「</span><br><span class="line">length: 300</span><br><span class="line"></span><br><span class="line">甲:「你好!」乙:「我很好,謝謝你.」丙:「你怎麼了?」丁:「沒事,只是有點感冒,請你多保重,我會好好照顧你的.」「謝謝,」甲說,「我一定會照顧好你的,你放心吧!」「好,我放心了!我一定要好好保護你,不要讓</span><br><span class="line">任何人傷害你!你一定要保護好自己,別讓別人傷害自己!你要好好愛惜自己的身體,要好好養生!不要生病!要養好身體!我要好好地照顧你！」乙說:「好!謝謝你的關心!我會照顧好的!你也一定要好好的照顧我!我們一起努力!一起加油!加油！」丙說：「我真的很感謝你對我的照顧!我也很想你啊!我好想見見你呀!好想!我很想聽你說話!我想聽聽你的聲音,我想和你說話,想和你聊天!可是我怕你聽不到我說話的聲音,因為我害怕你 聽到我的聲音會生氣,會不高興,所以我就不敢說!因為我知道,如果我不說的話,你會生氣、不開心!所以,我要說出來,讓你知道我有多愛你、有多想你好好地愛護我、照顧我好嗎?」「我當然會!我相信你愛我,我也相 信你對我很好!但是,如果你不愛我了,我不會怪你的!我不怪你什麼!我只怪我自己太愛</span><br></pre></td></tr></table></figure>
<p>看起來整個壞掉了阿，後面一直在跳針，是可以閱讀但是沒有邏輯，可能是輸入資訊量太少嗎<br>
隨便找個網文小說來給他產產看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">prompt: 葉琮叼著一根稻草，雙手抱後腦勺，用一本書蓋在臉上，擋住直射來的陽光，愜意的躺在山坡草地上享受著午休時光。&quot;葉琮哥！&quot;一個紅頭發的小男孩兒揮著手跑了過來。葉琮無奈的睜開眼，在他頭上輕輕敲了一下：&quot;焱，說過多少次了，不要在我午休的時候打擾我。&quot;對於像他這樣喜歡在夜晚活動的打更人來說，午休是格外重要的。</span><br><span class="line">length: 500</span><br><span class="line"></span><br><span class="line">葉琮叼著一根稻草，雙手抱後腦勺，用一本書蓋在臉上，擋住直射來的陽光，愜意的躺在山坡草地上享受著午休時光。&quot;葉琮哥！&quot;一個紅頭發的小男孩兒揮著手跑了過來。葉琮無奈的睜開眼，在他頭上輕輕敲了一下：&quot;焱，說過多少次了，不要在我午休的時候打擾我。&quot;對於像他這樣喜歡在夜晚活動的打更人來說，午休是格外重要的。但是，他卻從來沒有過午睡的習慣，所以，在葉家，只有他一個人午睡了，其他的人都是睡覺的。他睡得特別香，睡得很安穩，甚至連呼吸聲都聽得到。這天，葉家的午飯時間到了，大家都在院子裡吃著飯。突然，一個聲音響起：&quot;喂！葉哥，你醒醒，快起來吃午點吧。&quot;&quot;我怎麼會醒來啊？我睡著了，怎麼</span><br><span class="line">可能醒過來？&quot;&quot;你睡著的時候，我一直在看書，看什麼書啊？&quot;一個大大的黑眼睛，一雙黑亮的大眼睛。這個黑眼珠子，就是葉瑋瑄。她長得很漂亮，眼睛很大，很亮，而且很黑，就像一顆黑珍珠。她的臉蛋很圓潤</span><br><span class="line">，五官很完美，皮膚很白皙，眉毛很濃，嘴唇很紅，鼻子很挺，嘴巴很薄，下巴很尖，小巧玲瓏，嬌小可人，非常惹人憐愛。可是，她卻是個很膽小的孩子，膽小得連自己都害怕，更別提別人了。有一次，她在院子里玩，不小心跌倒在地，被一個小男孩撞到了。那個男孩一看到她，就跑過來抱住了她。那時候，她的心就像被針扎了一樣，疼得直發抖，但是她還是咬著牙，勇敢的站了起來，跑向了院子的另一邊。就在她跑得快，腳步蹣跚，快要摔倒時，突然有一股力量把她從地上拉了回來。原來，那個小男生就是她爺爺，爺奶奶，還有她外婆。他們都抱著她哭著跑來，抱住她說：&quot;葉</span><br></pre></td></tr></table></figure>
<p>問題好像還是一樣，還算可以閱讀，但完全沒有邏輯</p>
<p>讓他產產看英文好了，他的 base model 應該是英文的模型吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">prompt: Japan&#x27;s Prime Minister Fumio Kishida has been criticised for saying the country&#x27;s ban on same-sex marriage is not discriminatory. Weeks ago, he apologised to the LGBTQ community over homophobic comments made by an aide who has since been sacked. Mr Kishida&#x27;s party is under growing pressure to improve LGBTQ rights, as more Japanese support same-sex marriage. Japan remains</span><br><span class="line">length: 500</span><br><span class="line"></span><br><span class="line">Japan&#x27;s Prime Minister Fumio Kishida has been criticised for saying the country&#x27;s ban on same-sex marriage is not discriminatory. Weeks ago, he apologised to the LGBTQ community over homophobic comments made by an aide who has since been sacked. Mr Kishida&#x27;s party is under growing pressure to improve LGBTQ rights, as more Japanese support same-sex marriage. Japan remains one of the few countries in the world to ban same-sex marriage, but the government has said it will not change its position.</span><br><span class="line"></span><br><span class="line">The government&#x27;s decision to allow same sex marriage in Japan was announced in March, after a government-appointed panel of judges ruled that the law was discriminating against gay people. The ruling was criticised by the gay community, who said they were being discriminated against by Japan&#x27;s government. In a statement, the Japan Society for the Prevention of Cruelty to Animals (JSPCA) said: &quot;We are deeply saddened by this ruling.&quot;</span><br><span class="line"></span><br><span class="line">&quot;We strongly condemn the ruling and urge the Japanese government to reconsider its decision,&quot; the group said. &quot;It is clear that Japan has a long way to go before it is able to fully respect the rights of all people, regardless of their sexual orientation or gender identity, to live in harmony with one another and to enjoy the same rights and freedoms as everyone else in society, including the right to marry and have a family. This ruling is a clear example of how Japan continues to discriminate against the most vulnerable and marginalised groups of society. It is also a sign of a lack of respect for human rights in this country, which is why we are calling on Japan to take urgent steps to ensure that all its citizens enjoy equal rights to life, liberty, and the pursuit of happiness, without discrimination based on their gender, sexuality, religion, or political beliefs.</span><br><span class="line"></span><br><span class="line">(Reporting by Yuki Yamaguchi; Editing and editing by David Jones)&lt;/s&gt;</span><br></pre></td></tr></table></figure>
<p>有些瑕疵但好像還行，中間還跑出 Japan Society for the Prevention of Cruelty to Animals (動保團體)?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">prompt: # calculate Fibonacci sequence\ndef fibo(x):</span><br><span class="line">length: 200</span><br><span class="line"></span><br><span class="line"># calculate Fibonacci sequence</span><br><span class="line">def fibo(x):</span><br><span class="line"></span><br><span class="line">    return x**2 + x + 1</span><br><span class="line"></span><br><span class="line"># generate a random number</span><br><span class="line">rand = random.randrange(0, 100)</span><br><span class="line">print(rand)</span><br><span class="line"></span><br><span class="line">&lt;/s&gt;</span><br></pre></td></tr></table></figure>
<p>想說測試一下他會不會寫 code，他格式有寫對，但產出來是不正確的結果，還自己寫了額外的產亂數的 code<br>
對一個 2GB 的繁體中文模型是不是要求太多了xD</p>
<h2 id="結論">結論</h2>
<p>總結來說，用新聞的文章讓他接龍產出來的文字還算通順邏輯也沒問題，但是寫小說就完全不行，會一些英文也會一些 code，以一個 2GB 的小模型來看，還算可以吧，不知道哪時候會釋出 1760B 參數的模型出來，不過釋出了應該也是個 360 GB 的模型，我的電腦就玩不起了呀xD</p>
<hr>
<ol>
<li><a target="_blank" rel="noopener" href="https://towardsdatascience.com/getting-started-with-bloom-9e3295459b65">https://towardsdatascience.com/getting-started-with-bloom-9e3295459b65</a></li>
<li><a target="_blank" rel="noopener" href="https://huggingface.co/ckip-joint/bloom-1b1-zh">https://huggingface.co/ckip-joint/bloom-1b1-zh</a></li>
<li><a target="_blank" rel="noopener" href="https://udn.com/news/story/7240/6991226">https://udn.com/news/story/7240/6991226</a></li>
</ol>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2023/03/02/bloom-zh/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2023-02-27T16:00:00.000Z" title="2/28/2023, 12:00:00 AM">2023-02-28</time></span><i class="material-icons">schedule</i><span class="level-item">6 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">資安</a><span> / </span><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/%E9%9B%9C%E8%AB%87/">雜談</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/28/ubuntu-kernel-version/">【資安小知識】Linux Kernel 出漏洞 Ubuntu 該升級哪一版?</a></h1><div class="content"><p>因為去年底出的一個新的 Kernel 漏洞 CVE-2022-47939，要幫忙檢查 Ubuntu 有沒有需要更新 Kernel，所以就寫了這篇記錄一下。</p>
<p>首先，這個漏洞在 <a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47939">mitre 的 cve 頁面</a> 中寫了影響的範圍是 <code>Linux kernel 5.15 through 5.19 before 5.19.2</code>，出問題的是 ksmbd 這個 kernel module，他是在 5.15 版本被引入的，所以 5.15 之前的版本就沒事，最後是在 <a target="_blank" rel="noopener" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=cf6531d98190fa2cf92a6d8bbc8af0a4740a223c">這個 commit</a> 中修掉的，這個 commit 的 message 是 <code>ksmbd: fix use-after-free bug in smb2_tree_disconect</code>，跟在 mitre 的 cve 的敘述中寫的一樣，在頁面下方的 References 其實也可以看到這個 commit 的連結。</p>
<p>所以我們知道有問題的 Linux Kernel 版本是什麼，但是我要怎麼在 Ubuntu 上面看我的 Linux Kernel 是幾版，上網查一下或是問 chatgpt，其實就可以得到這個指令 <code>uname -r</code>，執行這個指令之後，在我的機器上給出了 <code>5.15.0-58-generic</code> 這樣的版本號，看起來是 5.15 版本，是在有漏洞的範圍裡面，但其實並沒有，因為這是 Ubuntu 自己 build 的版本號，並不是 Linux Kernel 的版本號，Ubuntu 的版本號的命名慣例是 <code>&lt;base kernel version&gt;-&lt;ABI number&gt;.&lt;upload number&gt;-&lt;flavour&gt;</code>，你會發現把剛剛的 <code>5.15.0-58-generic</code> 套在這個格式上看好像少了一個 upload number，我們可以用 <code>cat /proc/version_signature</code> 查看比較詳細的版本號，在我的機器上的結果是 <code>Ubuntu 5.15.0-58.64-generic 5.15.74</code>，分別是</p>
<ul>
<li>base kernel version: 5.15.0</li>
<li>ABI number: 58</li>
<li>upload number: 64</li>
<li>flavour: generic</li>
<li>upstream linux kernel: 5.15.74</li>
</ul>
<p>最後他還多給了一個 upstream linux kernel 的版本號。ABI number 指的是 kernel 本身開出來的 application binary interface 介面的版本號，如果你把 kernel 看成是一個後端 server，那他就是指你的 REST API 的接口，所以可能會跟 upload number 不同，因為可能兩個不同的 kernel 版本只是修了些 bug，沒有開新的 api，或是 api 的參數沒有變化，這時候這個 ABI number 就不會變。而 upload number 單純就是一個流水號，指從這個 <code>5.15.0</code> base kernel version 長出來的第幾個版本，所以我們可以看這個號碼來分辨前後順序。</p>
<p>在 <a target="_blank" rel="noopener" href="https://ubuntu.com/security/CVE-2022-47939">Ubuntu Secuity: CVE-2022-47939</a> 發布的漏洞公告中，我們可以看到他有列出他們上 patch 的版本，Ubuntu 22.04 (jammy) 的是 <code>5.15.0-53.59</code>，我們可以直接去看 <a target="_blank" rel="noopener" href="https://launchpad.net/ubuntu/+source/linux/5.15.0-53.59">Ubuntu linux source package 中 <code>5.15.0-53.59</code> 版本的 Changlog</a>，這裡我們搜尋 <code>smb2_tree_disconect</code> 就可以找到在這個版本的更新有納入 <code>v5.15.61</code> upstream linux kernel 其中修掉了這次的 CVE-2022-47939，而我的機器是 <code>5.15.0-58.64</code>，是在 <code>5.15.0-53.59</code> 後面的，所以其實我的機器的 Linux Kernel 已經有修補掉這個漏洞了。</p>
<p>總結來說，在 Ubuntu 下 <code>uname -r</code> 得到的版本號其實不能直接對應到 Linux Kernel 的版本號，Ubuntu 本身是從 Linux 分支出來的，所以自己有一個版本號，我們這次介紹了 Ubuntu 版本號各個欄位的意思，並且找到我們的版本號其實是已經有上 patch 了，這樣之後出新的漏洞就可以知道要升級到哪個版本可以修補掉漏洞。</p>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2023/02/28/ubuntu-kernel-version/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2022-12-14T16:00:00.000Z" title="12/15/2022, 12:00:00 AM">2022-12-15</time></span><i class="material-icons">schedule</i><span class="level-item">4 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E5%85%B6%E4%BB%96/">其他</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/15/wtf-powershell/">【程式語言】WTF Powershell</a></h1><div class="content"><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span>..<span class="number">4</span>+,<span class="number">2</span></span><br><span class="line"><span class="number">3</span>..<span class="number">4</span>+<span class="number">2</span></span><br><span class="line"><span class="number">2</span>+<span class="number">3</span>..<span class="number">4</span></span><br><span class="line">,<span class="number">2</span>+<span class="number">3</span>..<span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>以上四句表達式，哪一個是不合法的表達式呢?</p>
<p>…<br>
<br><br>
<br><br>
<br></p>
<p>答案是第三句 <code>2+3..4</code>，他會噴出以下的 error</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">方法引動過程失敗，因為 [<span class="type">System.Object</span>[]] 未包含名為 <span class="string">&#x27;op_Addition&#x27;</span> 的方法。</span><br><span class="line">位於 線路:<span class="number">1</span> 字元:<span class="number">1</span></span><br><span class="line">+ <span class="number">2</span>+<span class="number">3</span>..<span class="number">4</span></span><br><span class="line">+ ~~~~~~</span><br><span class="line">    + CategoryInfo          : InvalidOperation: (op_Addition:String) []，RuntimeException</span><br><span class="line">    + FullyQualifiedErrorId : MethodNotFound</span><br></pre></td></tr></table></figure>
<h2 id="一些背景知識">一些背景知識</h2>
<p>在詳細講解為什麼 <code>2+3..4</code> 會出錯之前，我們首先要理解 powershell 中的四個概念，都很好理解(有學過其他語言的話O_O)，分別是</p>
<ul>
<li>create array</li>
<li>nested array</li>
<li>append array</li>
<li>range</li>
</ul>
<h3 id="create-array">create array</h3>
<p>要 create 一個 array 很簡單，只要用 <code>,</code> 逗號把數字隔開，像是 <code>1,2,3</code> 這樣，就是一個 array 了，不一定要有括號在外面</p>
<h3 id="nested-array">nested array</h3>
<p>兩個逗號的話，像這樣 <code>,,1</code> 就是一個兩層的 nested array，等同於 python 的 <code>[[1]]</code></p>
<h3 id="append-array">append array</h3>
<p>在 powershell 中，串接陣列是用 <code>+</code>，要 <code>,2</code> 陣列和 <code>,3</code> 陣列串接的話就是 <code>,2+,3</code>，等同於 python 的 <code>[2] + [3]</code></p>
<h3 id="range">range</h3>
<p>和其他的一些語言(bash, rust, …)一樣，powershell 是採用 <code>..</code> 來作為 range operator，像是 <code>1..5</code> 就等於 <code>1,2,3,4,5</code></p>
<h2 id="WTF-Powershell">WTF Powershell</h2>
<p>在複習了一些 powershell 的背景知識後，我們就來看看為什麼 <code>2+3..4</code> 會是不合法的表達式，明明對稱的另一個表達式 <code>3..4+2</code> 是合法的阿<br>
首先就運算元的優先序來看，是 <code>,</code> &gt; <code>..</code> &gt; <code>+</code> 的，所以我們可以把上面的四個表達式寫成</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">3</span>..<span class="number">4</span>)+(,<span class="number">2</span>)</span><br><span class="line">(<span class="number">3</span>..<span class="number">4</span>)+<span class="number">2</span></span><br><span class="line"><span class="number">2</span>+(<span class="number">3</span>..<span class="number">4</span>)</span><br><span class="line">(,<span class="number">2</span>)+(<span class="number">3</span>..<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<p>實際上這四句分別是</p>
<ul>
<li><code>Object[] + Object[]</code></li>
<li><code>Object[] + Int32</code></li>
<li><code>Int32 + Object[]</code></li>
<li><code>Object[] + Object[]</code></li>
</ul>
<p>回頭看一下 error message 你就會發現它其實就是在說不能把 <code>Int32 + Object[]</code><br>
但是 <code>Object[] + Int32</code> 卻可以，所以他只實作了一個方向的加法? WTF Powershell?<br>
不過換個方向，用 python 的角度來看，他其實像是 <code>a = [3, 4]; a.append(2)</code> 是可以的，但是沒有 <code>a = 2; a.append([3, 4])</code> 這種寫法</p>
<p>總而言之，因為 Powershell 把 <code>Object[]</code> 和 <code>Object[]</code> 的 concat 和 <code>Object[]</code> 和 <code>Int32</code> 的 append 混著用都是用 <code>+</code> 一個 operator 搞定，所以第一次看的時候會有些頭昏眼花，但其實還勉強算合理，不像隔壁棚的 javascript 群魔亂舞的。Powershell 的部分之後應該還會有更新，大家下集再見。</p>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2022/12/15/wtf-powershell/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2022-11-11T16:00:00.000Z" title="11/12/2022, 12:00:00 AM">2022-11-12</time></span><i class="material-icons">schedule</i><span class="level-item">19 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">資安</a><span> / </span><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/writeups/">writeups</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/11/12/flare-on-9/">【Writeups】Flare-on 9</a></h1><div class="content"><p align="center"><img data-src="/images/flare-on-9.png" class=" lazyload"  title="flare-on 9 completed!!!"></p>
<h2 id="01-Flaredle">01 - Flaredle</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">CORRECT_GUESS</span> = <span class="number">57</span>;</span><br><span class="line"><span class="keyword">let</span> rightGuessString = <span class="variable constant_">WORDS</span>[<span class="variable constant_">CORRECT_GUESS</span>];</span><br><span class="line"><span class="keyword">if</span> (guessString === rightGuessString) &#123;</span><br><span class="line">    <span class="keyword">let</span> flag = rightGuessString + <span class="string">&#x27;@flare-on.com&#x27;</span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>flag 就是 <code>WORDS[57]</code></p>
<h2 id="02-Pixel-Poker">02 - Pixel Poker</h2>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (x == <span class="number">0x52414c46</span> % <span class="number">741</span> &amp;&amp; y == <span class="number">0x6e4f2d45</span> % <span class="number">641</span>) &#123;</span><br><span class="line">    <span class="meta"># print flag</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>點選 <code>(95, 313)</code> 這個格子就會噴出 flag 如下</p>
<p align="center"><img data-src="/images/02-flag.png" class=" lazyload"  width="500" title="flare-on challenge 02 flag"></p>
<h2 id="03-Magic-8-Ball">03 - Magic 8 Ball</h2>
<p>按 <code>LLURULDUL</code> 方向鍵<br>
然後在下面輸入 <code>gimme flag pls?</code> 就會噴出 flag 如下</p>
<p align="center"><img data-src="/images/03-flag.png" class=" lazyload"  width="500" title="flare-on challenge 03 flag"></p>
<h2 id="04-darn-mice">04 - darn_mice</h2>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="type">void</span> *ptr = <span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">    *ptr = payload[i] + input[i];</span><br><span class="line">    (<span class="type">void</span>(*)())(ptr)();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>每個 byte 都會被當成 1-byte shellcode 呼叫，只有全部都是 <code>0xc3</code> 也就是 ret 才不會 crash</p>
<p>flag 是 <code>i_w0uld_l1k3_to_RETurn_this_joke@flare-on.com</code></p>
<h2 id="05-T8">05 - T8</h2>
<p>這題給了一隻 PE 執行檔和一包 pcap</p>
<p>程式一開始會有個 anti-debug，判斷時間是滿月的時候才能執行<br>
他有一個函式是在計算月亮的週期 OwO</p>
<p>pcap 裡面有兩個 requests 兩個 response<br>
總之動態追一下可以發現他計算 request 內容的邏輯<br>
基本上他就是用 RC4 加密，他產的 key 是 <code>FO9</code> 加上 0 到 65535 之間隨機一個數字，比如 <code>FO91234</code>，做 md5 的結果<br>
所以爆搜一下就可以解出封包的內容，爆搜程式碼如下，要注意 wide string 的轉換 O_O</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_wide</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span>.join([<span class="built_in">bytes</span>([i, <span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> x])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_wide</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">enumerate</span>(x):</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span> <span class="keyword">and</span> j != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> to_wide(hashlib.md5(to_wide(x)).hexdigest().encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4</span>(<span class="params">key, m</span>):</span><br><span class="line">    <span class="keyword">return</span> ARC4.new(key).encrypt(m)</span><br><span class="line"></span><br><span class="line">enc_req = b64decode(<span class="string">&quot;ydN8BXq16RE=&quot;</span>)</span><br><span class="line">enc_res = b64decode(<span class="string">&quot;TdQdBRa1nxGU06dbB27E7SQ7TJ2+cd7zstLXRQcLbmh2nTvDm1p5IfT/Cu0JxShk6tHQBRWwPlo9zA1dISfslkLgGDs41WK12ibWIflqLE4Yq3OYIEnLNjwVHrjL2U4Lu3ms+HQc4nfMWXPgcOHb4fhokk93/AJd5GTuC5z+4YsmgRh1Z90yinLBKB+fmGUyagT6gon/KHmJdvAOQ8nAnl8K/0XG+8zYQbZRwgY6tHvvpfyn9OXCyuct5/cOi8KWgALvVHQWafrp8qB/JtT+t5zmnezQlp3zPL4sj2CJfcUTK5copbZCyHexVD4jJN+LezJEtrDXP1DJNg==&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span> * <span class="number">256</span>):</span><br><span class="line">    key = gen_key(<span class="string">b&#x27;FO9&#x27;</span> + <span class="built_in">str</span>(i).encode())</span><br><span class="line">    dec_req = rc4(key, enc_req)</span><br><span class="line">    <span class="keyword">if</span> check_wide(dec_req):</span><br><span class="line">        dec_res = rc4(key, enc_res)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dec_req)</span><br><span class="line"><span class="built_in">print</span>(dec_res)</span><br></pre></td></tr></table></figure>
<p>然後解出第一個封包的內容之後，裡面的內容是用 <code>,</code> 分開的如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">\xe5\x07\t\x00\x03\x00\x0f\x00\r\x00%\x00\x03\x00b\x02</span><br><span class="line">\x00\xdc\x07\n\x00\x06\x00\r\x00\r\x00%\x00\t\x00*\x03</span><br><span class="line">\x00\xe1\x07\x0c\x00\x04\x00\x07\x00\r\x00%\x00$\x00\xe5\x00</span><br><span class="line">\x00\xe0\x07\x05\x00\x05\x00\x06\x00\r\x00%\x00\x0b\x00&amp;\x00</span><br><span class="line">\x00\xe2\x07\n\x00\x01\x00\x08\x00\r\x00%\x00\x1f\x00E\x03</span><br><span class="line">\x00\xe6\x07\x03\x00\x02\x00\x01\x00\r\x00%\x002\x00\xda\x00</span><br><span class="line">\x00\xde\x07\x07\x00\x02\x00\x16\x00\r\x00%\x006\x00\xd1\x02</span><br><span class="line">\x00\xde\x07\x05\x00\x03\x00\x0e\x00\r\x00%\x00\x01\x00\xe8\x00</span><br><span class="line">\x00\xda\x07\x04\x00\x01\x00\x05\x00\r\x00%\x00:\x00\x0b\x00</span><br><span class="line">\x00\xdd\x07\n\x00\x04\x00\x03\x00\r\x00%\x00\x16\x00\x16\x03</span><br><span class="line">\x00\xde\x07\x01\x00\x02\x00\x0e\x00\r\x00%\x00\x10\x00\xc9\x00</span><br><span class="line">\x00\xdc\x07\x0c\x00\x01\x00\n\x00\r\x00%\x000\x00\x0c\x02</span><br><span class="line">\x00\xe6\x07\x02\x00\x01\x00\x1c\x00\r\x00%\x00&quot;\x00K\x01</span><br><span class="line">\x00\xe6\x07\t\x00\x05\x00\t\x00\r\x00%\x00!\x00m\x01</span><br></pre></td></tr></table></figure>
<p>每行都是代表某年某月某日，然後算一下是陰曆幾號，再把那個數字對到 <code>a-z0-9</code> 就可以組出 flag 了，大概吧 O3O?<br>
反正後來我覺得好麻煩，就直接把解出來的封包內容倒回去 debugger，flag 就掉出來了 O_O</p>
<p>flag 是 <code>i_s33_you_m00n@flare-on.com</code></p>
<p><a target="_blank" rel="noopener" href="https://github.com/oalieno/CTF/tree/master/flare-on/9/05">看 code 點我</a></p>
<h2 id="06-a-la-mode">06 - à la mode</h2>
<p>這題乍看之下是 .NET 程式<br>
但用 dnspy 翻了一下發現沒什麼東西<br>
在逛 PEBear 的時候就看到了 .NET Header 裡面的 Flags 寫了 Native EntryPoint</p>
<p align="center"><img data-src="/images/06-pe-bear.png" class=" lazyload"  title="flare-on challenge 06 pe bear result"></p>
<p>咦?難道這是隻普通的 dll<br>
直接抄起我的 IDA Pro 和 x64dbg<br>
咻咻咻，一陣亂跳，看到了一些 pipe 的東西，再多翻一下就翻到某個地方長得很像是在 decode flag 的地方，還有出現 <code>MyV0ic3</code> 字串<br>
難道是要 create pipe 然後傳這個字串，好像很麻煩，我直接手起刀落把 cmp 的另一個變數一樣改成 <code>MyV0ic3</code>，再按了幾下 step over，登登，flag 就出現在 memory 了</p>
<p align="center"><img data-src="/images/06-flag.png" class=" lazyload"  title="flare-on challenge 06 flag"></p>
<p>flag 是 <code>M1x3d_M0dE_4_l1f3@flare-on.com</code></p>
<p>p.s. 解這題的時候剛好要出門吃飯，原本想說只是先看一下題目，沒想到 flag 就自己掉出來了xD</p>
<h2 id="07-anode">07 - anode</h2>
<p>這隻程式是用 node.js 寫的，是用 <a target="_blank" rel="noopener" href="https://github.com/nexe/nexe">nexe</a> 這個東西打包的<br>
用文字編輯器打開看一下就會發現檔案最後面有 js 原始碼</p>
<p>js 原始碼裡面有一大堆的 switch case<br>
主要的邏輯就是把你的輸入 -&gt; 做一連串的 add, sub, xor 的操作 -&gt; 檢查跟某個值是不是一樣的，是的話你的輸入就是 flag</p>
<p>我們可以直接去改最後的 js 原始碼，只要讓整個檔案的大小不變就不會噴 error，他執行的時候應該是直接抓一個固定的 offset?<br>
加了一行 <code>require(&quot;a.js&quot;)</code>，這樣我就可以直接跑我自己的 js<br>
簡單測試了一下，發現 node.js 被改過了，random 的輸出不 random，其他一些運算也被改過<br>
正常來說是要比對一下原版的 node.js 和這個改過的 node.js 差在哪裡<br>
但是我覺得好麻煩，我直接用 visual studio code 的超強 replace 功能把那一大串的 add 換成 sub，sub 換成 add，然後當做字串推到一個陣列<br>
接著把陣列倒過來，拿去 <code>eval</code> 就可以 flag 了 OwO</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 原本</span></span><br><span class="line"><span class="comment">case 1071664271:</span></span><br><span class="line"><span class="comment">        if (Math.random() &lt; 0.5) &#123;</span></span><br><span class="line"><span class="comment">          b[17] += b[0] + b[35] + b[12] + b[42] + b[14] + b[3] + 8;</span></span><br><span class="line"><span class="comment">          b[17] &amp;= 0xFF;</span></span><br><span class="line"><span class="comment">        &#125; else &#123;</span></span><br><span class="line"><span class="comment">          b[18] ^= (b[20] + b[23] + b[6] + b[12] + b[4] + b[25] + Math.floor(Math.random() * 256)) &amp; 0xFF;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        state = 175099911;</span></span><br><span class="line"><span class="comment">        continue;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 處理過</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">1071664271</span>:</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &lt; <span class="number">0.5</span>) &#123;</span><br><span class="line">          commands.<span class="title function_">push</span>(<span class="string">`b[17] -= b[0] + b[35] + b[12] + b[42] + b[14] + b[3] + 8`</span>);</span><br><span class="line">          commands.<span class="title function_">push</span>(<span class="string">`b[17] &amp;= 0xFF`</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          commands.<span class="title function_">push</span>(<span class="string">`b[18] ^= (b[20] + b[23] + b[6] + b[12] + b[4] + b[25] + <span class="subst">$&#123;<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">256</span>))&#125;</span> &amp; 0xFF`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        state = <span class="number">175099911</span>;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = [<span class="number">106</span>, <span class="number">196</span>, <span class="number">106</span>, <span class="number">178</span>, <span class="number">174</span>, <span class="number">102</span>, <span class="number">31</span>, <span class="number">91</span>, <span class="number">66</span>, <span class="number">255</span>, <span class="number">86</span>, <span class="number">196</span>, <span class="number">74</span>, <span class="number">139</span>, <span class="number">219</span>, <span class="number">166</span>, <span class="number">106</span>, <span class="number">4</span>, <span class="number">211</span>, <span class="number">68</span>, <span class="number">227</span>, <span class="number">72</span>, <span class="number">156</span>, <span class="number">38</span>, <span class="number">239</span>, <span class="number">153</span>, <span class="number">223</span>, <span class="number">225</span>, <span class="number">73</span>, <span class="number">171</span>, <span class="number">51</span>, <span class="number">4</span>, <span class="number">234</span>, <span class="number">50</span>, <span class="number">207</span>, <span class="number">82</span>, <span class="number">18</span>, <span class="number">111</span>, <span class="number">180</span>, <span class="number">212</span>, <span class="number">81</span>, <span class="number">189</span>, <span class="number">73</span>, <span class="number">76</span>];</span><br><span class="line">commands.<span class="title function_">reverse</span>().<span class="title function_">forEach</span>(<span class="function"><span class="params">command</span> =&gt;</span> <span class="built_in">eval</span>(command));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b)</span><br></pre></td></tr></table></figure>
<p>flag 是 <code>n0t_ju5t_A_j4vaSCriP7_ch4l1eng3@flare-on.com</code></p>
<p>p.s. 雖然 flag 說 <code>not just a javascript challenge</code>，但是我完全把他當作 javascript 來解了，抱歉了xD</p>
<h2 id="08-backdoor">08 - backdoor</h2>
<p>這題被大家說是全部裡面最難的，我覺得是蠻麻煩的，找不到地方偷吃步，或是其實有但我不知道xD (可以偷偷告訴我 O_O)</p>
<p>這隻是 .NET 的程式，dnspy 打開會看到一堆的 try except<br>
一開始跑下去都會進到 except 裡面<br>
因為他是在 except 裡面去建出一個 <code>DynamicMethod</code>，再把正確的 IL code 塞進去跑<br>
但如果你直接把動態跑的時候看到的那段 IL code 抓下來塞回去檔案裡面，會發現還是錯的<br>
因為他有一段是在做 <code>dynamicILInfo.GetTokenFor</code>，是在把外面世界的 metadata token 換成 dynamicILInfo 世界中的 metadata token，所以不能直接把那個 IL 複製出來，要複製再早一點還沒有換掉的，然後把正確的 metadata token 放上去<br>
這邊我因為沒有找到好方法 (對 .NET 不熟 QQ)，所以是用 dyspy 動態跑，手動複製出 IL code 和 metadata token，然後寫個 python script 去改原本的執行檔，最後可以正常的 decompile 所有函式</p>
<p>接著看到了一些 powershell command <code>$(ping -n 1 10.10.21.201 | findstr /i ttl) -eq $null;</code> 拿去 google 了一下就找到了這篇 <a target="_blank" rel="noopener" href="https://www.malwarebytes.com/blog/threat-intelligence/2022/05/apt34-targets-jordan-government-using-new-saitama-backdoor">APT34 targets Jordan Government using new Saitama backdoor</a><br>
長得一模一樣，這題就是從這隻惡意程式改的</p>
<p>其中在處理不同的 task 的部分有發現一些在做比較字串的程式碼<br>
感覺跟 flag 有關，就仔細看了一下，發現他是要依照某個順序把每一個 task 都跑過一次，就會去印 flag<br>
他印 flag 的地方是從 PE 的 <code>5aeb2b97</code> 這個 section 抓資料出來，然後拿去解，中間還會跟 stacktrace 的字串攪在一起，十分的噁心<br>
後來受不了，沒有可以偷吃步的地方，還是乖乖地寫了一個 dns server 跟程式互動，按照步驟去發 task id，執行完之後就噴出 flag 了</p>
<p align="center"><img data-src="/images/08-flag.png" class=" lazyload"  title="flare-on challenge 08 flag"></p>
<p>flag 是 <code>W3_4re_Kn0wn_f0r_b31ng_Dyn4m1c@flare-on.com</code></p>
<p><a target="_blank" rel="noopener" href="https://github.com/oalieno/CTF/tree/master/flare-on/9/08">看 code 點我</a></p>
<h2 id="09-encryptor">09 - encryptor</h2>
<p>這隻是一個 Ransomware，標準的用 Symmetric Encryption 做加密，再用 Asymmetric Encryption 加密 Symmetric Encryption 的 key<br>
很快就可以看出他有做 chacha20<br>
但是一直找不到他用什麼 Asymmetric Encryption，一直在想是什麼複雜的加密演算法，一開始懷疑是 ECC，後來又再猜 NTRU<br>
我看那個迴圈感覺很像是在做快速冪，在想是哪個演算法會做快速冪，不會是 RSA 吧他寫的那麼複雜，到底是哪個，等等難道真的是 RSA<br>
後來測試一下，發現真的是 RSA，因為他在做大數的運算所以看起來很複雜，那些函式就只是在做加法乘法模運算而已 Orz</p>
<p>反正他就是把檔案做 chacha20 加密，加密用的 key 再用 RSA 做加密<br>
RSA 加密之前先用 <code>e=0x10001</code> 去算出對應的 <code>d</code>，然後加密是直接 <code>m^d % n</code><br>
等於我們直接用 <code>c^e % n</code> 去解密就好</p>
<p>flag 是 <code>R$A_$16n1n6_15_0pp0$17e_0f_3ncryp710n@flare-on.com</code></p>
<h2 id="10-Nur-getraumt">10 - Nur geträumt</h2>
<p>這題是 m68k 的程式，非常古老的東西，要古董 Mac 電腦才跑得起來<br>
不過我們只要照著提示去用 <a target="_blank" rel="noopener" href="https://www.gryphel.com/c/minivmac/">Mini vMac</a> 就可以跑起來了<br>
稍微互動一下就可以發現它其實就是在做 xor encryption，就是會把你輸入的 key 重複貼上直到跟被加密的內容等長，然後做 xor</p>
<p>所以重點就是，要輸入什麼 key?<br>
已知最後面一定是 <code>@flare-on.com</code> 所以可以先解出 key 的最後 13 bytes 是 <code> du etwas Zei</code><br>
然後搭配他在程式裡面塞的一堆提示，就可以找到這首歌 <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Fpu5a0Bl8eY">NENA | 99 Luftballons [1983] [Offizielles HD Musikvideo]</a><br>
google 一下他的歌詞就會發現第一句歌詞就是 key …<br>
有幾個不是英文字母的在裡面，不過 flag 都是英文，猜一下也還好</p>
<p align="center"><img data-src="/images/10-flag.png" class=" lazyload"  title="flare-on challenge 10 flag"></p>
<p>flag 是 <code>Dann_singe_ich_ein_Lied_fur_dich@flare-on.com</code></p>
<p>p.s. 這題最麻煩的步驟是把 encrypted flag 複製出來…</p>
<h2 id="11-The-challenge-that-shall-not-be-named">11 - The challenge that shall not be named.</h2>
<p>這題是用 python 寫的，用 <a target="_blank" rel="noopener" href="https://github.com/pyinstaller/pyinstaller">pyinstaller</a> 打包成 exe<br>
所以起手先用 <a target="_blank" rel="noopener" href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a> 解出原始的 pyc (版本是 3.7.0)<br>
然後再用 <a target="_blank" rel="noopener" href="https://github.com/rocky/python-decompile3">python-decompile3</a> 解回原本的 python source code<br>
接著就會發現他有用 <a target="_blank" rel="noopener" href="https://github.com/dashingsoft/pyarmor">pyarmor</a> 做混淆</p>
<p>直接用 python 去跑解出來的 <code>.py</code> 檔案，會發現它噴了一個錯誤，而且有 stacktrace，位置是在本地的 crypt 函式庫<br>
裡面有用到 linux 平台才有的東西，有點古怪<br>
我就直接去改那個 <code>crypt.py</code>，把 <code>import _crypt</code> 註解掉，然後就會發現他去呼叫 <code>crypt</code> 的時候找不到 <code>_crypt</code>，因為我們沒有 import 他<br>
可以直接讓他 <code>return None</code>，接著就又看到他去呼叫 <code>ARC4</code>，一樣直接改他</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ARC4</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;arc4&#x27;</span>, x)</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, y</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;arc4.encrypt&#x27;</span>, y)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> A()</span><br></pre></td></tr></table></figure>
<p>然後 flag 就被我們印出來了xD</p>
<p align="center"><img data-src="/images/11-flag.png" class=" lazyload"  title="flare-on challenge 11 flag"></p>
<p>flag 是 <code>Pyth0n_Prot3ction_tuRn3d_Up_t0_11@flare-on.com</code></p>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2022/11/12/flare-on-9/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2022-11-08T16:00:00.000Z" title="11/9/2022, 12:00:00 AM">2022-11-09</time></span><i class="material-icons">schedule</i><span class="level-item">6 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">資安</a><span> / </span><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/%E9%9B%9C%E8%AB%87/">雜談</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/11/09/cve-2022-41049/">【漏洞分析】CVE-2022-41049</a></h1><div class="content"><p>11/08 Windows 的 Patch Tuesday 中修補了兩個關於 Bypass Mark-of-the-Web (MOTW) 的漏洞，分別是 CVE-2022-41049 和 CVE-2022-41091，在 <a target="_blank" rel="noopener" href="https://breakdev.org/zip-motw-bug-analysis/">Exploring ZIP Mark-of-the-Web Bypass Vulnerability (CVE-2022-41049)</a> 這篇部落格中，有詳細的分析這個漏洞的細節，也是本篇部落格主要參考的來源</p>
<p>這個漏洞最早在 6 月在 twitter 上 <a target="_blank" rel="noopener" href="https://twitter.com/wdormann/status/1544411421731160065?s=20&amp;t=mqtK57HVNPv7MghFW7e7dw">Will Dormann 的貼文中</a> 就有提及<br>
並且在 10 月就有在野外觀察到這個漏洞被利用</p>
<h2 id="Alternative-Data-Stream-ADS">Alternative Data Stream (ADS)</h2>
<p>要解釋這個漏洞之前，要先說明一下什麼是 Alternative Data Stream (ADS)<br>
ADS 是 NTFS 檔案系統的一個功能，允許一個檔案可以有多個 Stream，也就是雖然檔名是一樣的，但是透過不同的 Stream 可以存取到不同的資料<br>
比如 <code>test.txt</code> 這個檔案可以有好幾種不同的 Stream</p>
<ul>
<li><code>test.txt::$DATA</code></li>
<li><code>test.txt:Zone.Identifier</code></li>
<li><code>test.txt:Hello</code></li>
<li><code>test.txt:World</code></li>
</ul>
<h2 id="MOTW">MOTW</h2>
<p>瀏覽器會把從網路下載下來的檔案，新增一個 <code>Zone.Identifier</code> 的 Stream，這就是傳說中的 Mark-of-the-Web (MOTW)<br>
我們可以用 Powershell 下指令 <code>Get-Item &lt;filename&gt; -Stream *</code> 來列出某個檔案的所有 Stream 如下圖所示</p>
<p align="center"><img data-src="/images/MOTW.png" class=" lazyload"  title="MOTW"></p>
<p>接著用 <code>Get-Content &lt;filename&gt; -Stream Zone.Identifier</code> 去印出 <code>Zone.Identifier</code> Stream 裡面的資料如下圖所示</p>
<p align="center"><img data-src="/images/Get-Zone-Identifier.png" class=" lazyload"  title="Get-Content Zone.Identifier"></p>
<p>可以看到 <code>Zone.Identifier</code> Stream 裡面存了 <code>ZoneId</code> 和 <code>HostUrl</code> 這些 metadata</p>
<p>那有 MOTW 的檔案可以做什麼?<br>
有 MOTW 的檔案就等於給其他軟體們一個資訊，這個檔案是來自網路，像是 WORD, EXCEL, Visual Studio 等軟體以及 Windows 本身，在處理這些檔案的時候就會格外小心，並且對使用者發出額外的警告，像是如下圖的這些警告</p>
<p align="center"><img data-src="/images/MOTW-Warning.png" class=" lazyload"  title="MOTW Warning"></p>
<h2 id="CVE-2022-41049">CVE-2022-41049</h2>
<p>背景知識都補充足夠了，那這個 CVE-2022-41049 的漏洞又是出了什麼問題<br>
正常情況中，檔案總管 (Explorer) 在解壓縮 zip 的時候，會把 zip 檔案的 MOTW 複製到解壓縮出來的所有檔案上面<br>
但是只要那個 zip 檔案是用某個特別的方法製作的時候，MOTW 就不會被傳遞下去，也就成功 Bypass MOTW</p>
<p>這個特別的製作方法，說起來也不是那麼特別，其實也是正常的 feature<br>
<strong>只要你的檔案在壓縮的時候是 read-only 的</strong><br>
<strong>在解壓縮的時候，因為檔案是 read-only 的關係，所以檔案總管就無法去寫入 MOTW 到解壓縮出的檔案上面</strong><br>
就是這麼簡單，非常簡單就可以實作</p>
<p>這篇 <a target="_blank" rel="noopener" href="https://breakdev.org/zip-motw-bug-analysis/">Exploring ZIP Mark-of-the-Web Bypass Vulnerability (CVE-2022-41049)</a> 部落格中，作者做了非常深入的調查，最後才發現只是這麼簡單的原因，原文分析的思路也推薦大家可以看看<br>
除了 zip，其他的打包格式比如 iso, vhd, gzip 等，也是新的 bypass MOTW 的方法<br>
整體來看，Mark-of-the-Web (MOTW) 其實不算是一個 Security Boundary，比較像是一個額外的警告功能，使用者在下載網路上的資源的時候還是要謹慎小心，多看幾眼xD</p>
<hr>
<ol>
<li><a target="_blank" rel="noopener" href="https://breakdev.org/zip-motw-bug-analysis/">https://breakdev.org/zip-motw-bug-analysis/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ithome.com.tw/news/154096">https://www.ithome.com.tw/news/154096</a></li>
</ol>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2022/11/09/cve-2022-41049/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2022-03-29T16:00:00.000Z" title="3/30/2022, 12:00:00 AM">2022-03-30</time></span><i class="material-icons">schedule</i><span class="level-item">3 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E5%85%B6%E4%BB%96/">其他</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/30/blog03/">【部落格開發】日誌 0x03</a></h1><div class="content"><h2 id="部落格要恢復更新啦">部落格要恢復更新啦</h2>
<p>距離上次更新也過了一年多了，期間為了更加客製化主題，還想過要自己從頭刻部落格，真是太天真了啊<br>
最後還是回來用新版的 icarus 主題，真香。<br>
之前是把 icarus 主題跟部落格綁在同個 repo 一起更新，但這樣不好管理，所以現在就直接 <a target="_blank" rel="noopener" href="https://github.com/oalieno/hexo-theme-icarus">fork 一份出來維護</a>，是用最版的 <code>5.0.0-rc.1</code>，之後有新版本就再 merge 進來就好了。把之前做過得一些改動都整合進主題了，還是自己客製化過得最對味啊。<br>
之後會慢慢把之前的文章再放回來，應該至少一週一更吧，希望xD</p>
<h2 id="icarus-大改版">icarus 大改版</h2>
<p>我之前用的 icarus 版本還在寫 <code>.ejs</code><br>
現在已經在寫 <code>.jsx</code> 了<br>
之前的部落格開發日誌上的程式碼有些可能都不能直接套用了<br>
不過不用擔心我現在已經把我改的程式碼推到 <a target="_blank" rel="noopener" href="https://github.com/oalieno/hexo-theme-icarus">這裡</a> 了</p>
<h2 id="Excerpt">Excerpt</h2>
<p>我發現 icarus 的 excerpt 可以寫在文章內容的開頭，而不用寫在 front matter<br>
中間加一個 <code>&lt;!-- more --&gt;</code> 和文章主體區隔<br>
像是下面這樣，或是看<a target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-icarus/blob/site/source/_posts/en/Getting-Started.md?plain=1">這裡範例</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Hello, this is the excerpt</span><br><span class="line"></span><br><span class="line">&lt;!-- more --&gt;</span><br><span class="line"></span><br><span class="line">This is the article</span><br></pre></td></tr></table></figure>
<p>這樣 excerpt 也可以快樂寫 markdown<br>
在首頁也只會顯示到 <code>&lt;!-- more --&gt;</code> 之前的內容<br>
但是點 Read More 的按鈕跳進去文章之後，會發現 excerpt 其實還在<br>
只是頁面會捲動到 <code>#more</code> 這個 hashtag 也就是文章主體的開頭<br>
不過這樣感覺只是一個偷懶的作法，不是一個完美的作法</p>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2022/03/30/blog03/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2021-02-26T16:00:00.000Z" title="2/27/2021, 12:00:00 AM">2021-02-27</time></span><i class="material-icons">schedule</i><span class="level-item">10 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E5%8D%80%E5%A1%8A%E9%8D%8A/">區塊鍊</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/02/27/flow/">【項目介紹】Flow ( Dapper Labs )</a></h1><div class="content"><p>這個項目算是很新的項目，去年的 9/22 - 10/3 才在第一波 ICO，每人限購 1000 USDC，當時 ICO 的價格是一顆 FLOW 要價 0.1 USDC，到現在也漲了 200 倍了吧，只恨沒有買更多啊 Orz 不過要鎖倉一年，所以要到今年底才拿的回來，但是光是產生的利息就已經回本好幾倍了xD<br>
好了，廢話不多說，下面來介紹一下 flow 的特點。</p>
<h2 id="資源">資源</h2>
<p>這邊先放幾個連結，有興趣入門的可以看一下</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.onflow.org/primer">官方寫的入門文章</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.onflow.org/">官方的文檔</a></li>
<li><a target="_blank" rel="noopener" href="https://joshuahannan.medium.com/taking-your-first-steps-with-cadence-19dde86bbd0">國外大佬的入坑指南</a></li>
</ul>
<h2 id="特點">特點</h2>
<p>Flow 是專門為應用程式以及遊戲所開發的一條新的區塊鍊<br>
在鍊上面可以用 Cadence 這個程式語言撰寫 smart contract，對比隔壁棚的 Ethereum 用 Solidity 寫 smart contract</p>
<h3 id="Cadence-這個程式語言有什麼特點呢">Cadence 這個程式語言有什麼特點呢</h3>
<ul>
<li><strong>Resource-Oriented Programming</strong>
<ul>
<li>聽說是參考 facebook 的 Libra 用的 Move 語言</li>
<li>跟 Rust 的 ownership 很像</li>
<li>可以看看下面兩篇 papers，在講怎麼樣設計一個適合用在 smart contract 上的語言
<ul>
<li><a target="_blank" rel="noopener" href="https://src.acm.org/binaries/content/assets/src/2018/michael-coblenz.pdf">Obsidian: A Safer Blockchain Programming Language</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cs.cmu.edu/~balzers/publications/digital_contracts_as_session_types.pdf">Resource-Aware Session Types for Digital Contracts</a></li>
</ul>
</li>
</ul>
</li>
<li><strong>Upgradable Smart Contract</strong>
<ul>
<li>多了一個 beta state 可以讓你盡情的 upgrade，在這個階段，如果使用這要用就要自行承擔風險囉，話是這樣說的</li>
<li>等到都測試完後，就可以正式 release 了，之後就跟隔壁棚 Ethereum 的 smart contract 一樣就不能再改他了</li>
</ul>
</li>
<li><strong>Built-in Logging Support</strong>
<ul>
<li>只會在 transaction 上標記一個記號，你想要看 log 就自己在離線執行一次就可以看到了，不像隔壁棚 Ethereum 把 log 儲存在鍊上面</li>
<li>在 Cadence 語言中就直接 <code>log(&quot;hi&quot;)</code> 就可以印 log 了，不像隔壁棚 Ethereum 還要先定義 event 再 emit</li>
</ul>
</li>
</ul>
<h3 id="Flow-這條區塊鍊有哪些特點呢">Flow 這條區塊鍊有哪些特點呢</h3>
<ul>
<li><strong>垂直分工 ( pipeline )</strong>，把問題切成四份，某種問題會有一種專門的節點負責處理
<ul>
<li>不像隔壁棚 Ethereum 尋求 sharding 的解決方式，用平行分工把所有交易切成很多子鍊，多了很多問題</li>
<li>分下面四種工作
<ul>
<li>Consensus Nodes    : 共識機制在此發功，Flow 使用 HotStuff 共識機制</li>
<li>Verification Nodes : 檢查正確性，取締違規者</li>
<li>Execution Nodes    : 執行交易附帶的那些計算工作，也就是 smart contract 裡面的程式</li>
<li>Collection Nodes   : 負責包裝交易們處理些雜事，再丟給 Consensus Nodes，用來提昇整體區塊鍊的效率</li>
</ul>
</li>
<li>總而言之
<ul>
<li>Consensus 和 Verification 這兩種 Node 是安全守門員負責讓 Flow 更安全</li>
<li>Execution 和 Collection 這兩種 Node 是瘋狂機器人負責讓 Flow 更有效率跑得更快</li>
</ul>
</li>
</ul>
</li>
<li>每個帳號裡面都可以有多個 smart contract，不像隔壁棚 Ethereum 的 smart contract 和 address 是一對一的關係</li>
<li>內建支援 <strong>multi-signature</strong>，每個 key 會有一個 weight，只有你提供的 key 們的 weight 加起來有 1000 就可以做事情了</li>
<li>聽官網介紹是說有<strong>帳號恢復機制</strong>，不清楚細節</li>
<li>強調說他遵守了資料庫系統的 ACID ( Atomic, Consistent, Isolated, and Durable ) 原則，因為根本上區塊鍊就是一個去中心化的資料庫</li>
</ul>
<h2 id="如何成為節點">如何成為節點</h2>
<p><a target="_blank" rel="noopener" href="https://docs.onflow.org/node-operation/node-setup">官方的文檔 - Setting Up a Flow Node</a></p>
<table>
<thead>
<tr>
<th>NODE TYPE</th>
<th>CPU</th>
<th>MEMORY</th>
<th>DISK</th>
</tr>
</thead>
<tbody>
<tr>
<td>Collection</td>
<td>2 cores</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
<tr>
<td>Consensus</td>
<td>2 coresv</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
<tr>
<td>Execution</td>
<td>16 cores</td>
<td>128 GB</td>
<td>2 TB</td>
</tr>
<tr>
<td>Verification</td>
<td>2 cores</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
<tr>
<td>Access</td>
<td>2 cores</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Make sure you have a sufficiently fast connection; we recommend at least 1Gbps, and 5Gbps is better.</p>
</blockquote>
<p>硬體要求還行，我的桌機好像還能跑，但是這個網速要求有點高啊<br>
而且還要填<a target="_blank" rel="noopener" href="https://www.onflow.org/node-validators">表單</a>申請，太中心化了啊<br>
然後<a target="_blank" rel="noopener" href="https://docs.onflow.org/node-operation/node-roles">這裡</a>有寫每種 node 要跑得話要 stake 多少顆 flow，最便宜也至少要 stake 135000 顆 flow，以目前的價格來看大概是 270 萬美金吧，我去</p>
<h2 id="Flow-目前的一些問題">Flow 目前的一些問題</h2>
<p>目前 Flow 還在初期階段，有些東西還沒搞好<br>
下面一些資訊是我在 discord 群看到的</p>
<blockquote>
<p>we still have a lot of things locked down in mainnet right now. The ability to create accounts is one of them. At this time only partnered wallets can create accounts. This will obviously be opened up in the future. At a minimum it won’t happen until fees are in place on mainnet.</p>
<ul>
<li>qvvg on discord</li>
</ul>
</blockquote>
<p>主網路還沒好啊，不能隨意創帳號<br>
需要他們合作的夥伴像是 blockto 才能創，可以用 <a target="_blank" rel="noopener" href="https://port.onflow.org/">https://port.onflow.org/</a> 這個創帳號的樣子<br>
還不夠去中心化啊</p>
<blockquote>
<p>Flow’s fee model is still under development, but will have transaction fees. The payer of a transaction can be separate from the authorizer, so dapps can easily pay for their users transactions. Flow keeps tx fees affordable and accessible for all.</p>
<ul>
<li>Flow Assistant Bot on discord</li>
</ul>
</blockquote>
<p>手續費的機制也還沒弄好啊</p>
<blockquote>
<p>Flow is an decentralized protocol being built in an open ecosystem - there is no formal roadmap but if you’d like to see areas people are currently expending effort you can take a look at issues currently in the GitHub repo <a target="_blank" rel="noopener" href="https://github.com/onflow/flow/issues">https://github.com/onflow/flow/issues</a> and feel free to create or comment on issues for anything that you think should exist on Flow.</p>
<ul>
<li>Flow Assistant Bot on discord</li>
</ul>
</blockquote>
<p>沒有正式的 roadmap</p>
<h2 id="Flow-的應用">Flow 的應用</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.nbatopshot.com/">NBA Top Shot</a>: NBA 主題的 NFT，可以讓你收藏你最愛的球員，以及他們得分的片段等</li>
<li><a target="_blank" rel="noopener" href="https://viv3.com/">VIV3</a>: 買賣 NFT 的平台</li>
<li><a target="_blank" rel="noopener" href="https://motogp-ignition.com/">MotoGP™ Ignition</a>: 類似 Ethereum 上的 <a target="_blank" rel="noopener" href="https://www.f1deltatime.com/">F1® Delta Time</a>，同一批開發人員的樣子，只是從 F1 賽車改成 MotoGP 摩托車，可以組裝自己的車車然後跟別人比賽，下個月 3/26 開賣</li>
<li><a target="_blank" rel="noopener" href="https://www.cryptokitties.co/">CryptoKitties</a>: 還在計畫從 Ethereum 遷移到 Flow，不知道是哪時候</li>
</ul>
<h2 id="總結">總結</h2>
<p>Flow 提出了很多方案來改進去中心化應用面臨到的問題，接下來就要靜待時間的考驗，等潮水退了就知道 Flow 有沒有穿褲子了</p>
<h2 id="Flow-to-the-Moon-🚀"><strong>Flow to the Moon 🚀</strong></h2>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2021/02/27/flow/#more">Read more</a></div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/page/0/">Previous</a></div><div class="pagination-next"><a href="/page/2/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li><li><a class="pagination-link" href="/page/4/">4</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/avatar.png" alt="oalieno"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">oalieno</p><p class="is-size-6 is-block">資安研究員</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Taiwan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">38</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">11</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">55</p></a></div></div></nav><div class="level"><a class="level-item button is-primary" href="https://github.com/oalieno" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/oalieno"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/oalieno"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Linkedin" href="https://www.linkedin.com/in/oalieno/"><i class="fab fa-linkedin"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI/"><span class="level-start"><span class="level-item">AI</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Windows/"><span class="level-start"><span class="level-item">Windows</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%85%B6%E4%BB%96/"><span class="level-start"><span class="level-item">其他</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%8D%80%E5%A1%8A%E9%8D%8A/"><span class="level-start"><span class="level-item">區塊鍊</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%BC%94%E7%AE%97%E6%B3%95/"><span class="level-start"><span class="level-item">演算法</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B3%87%E5%AE%89/"><span class="level-start"><span class="level-item">資安</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E8%B3%87%E5%AE%89/pwn/"><span class="level-start"><span class="level-item">pwn</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B3%87%E5%AE%89/writeups/"><span class="level-start"><span class="level-item">writeups</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B3%87%E5%AE%89/%E5%AF%86%E7%A2%BC%E5%AD%B8/"><span class="level-start"><span class="level-item">密碼學</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B3%87%E5%AE%89/%E9%80%86%E5%90%91/"><span class="level-start"><span class="level-item">逆向</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B3%87%E5%AE%89/%E9%9B%9C%E8%AB%87/"><span class="level-start"><span class="level-item">雜談</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-28T16:00:00.000Z">2023-10-29</time></p><p class="title"><a href="/2023/10/29/gashapon/">【Paper 解讀】打造公平的遊戲轉蛋：在不洩漏原始碼的前提下驗證虛擬轉蛋的機率</a></p><p class="categories"><a href="/categories/%E8%B3%87%E5%AE%89/">資安</a> / <a href="/categories/%E8%B3%87%E5%AE%89/%E9%9B%9C%E8%AB%87/">雜談</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-09-06T16:00:00.000Z">2023-09-07</time></p><p class="title"><a href="/2023/09/07/windows-facts-02/">【Windows 小知識】PE Section 大小</a></p><p class="categories"><a href="/categories/Windows/">Windows</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-08-14T16:00:00.000Z">2023-08-15</time></p><p class="title"><a href="/2023/08/15/windows-facts-01/">【Windows 小知識】檔案總管的排序規則</a></p><p class="categories"><a href="/categories/Windows/">Windows</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-01T16:00:00.000Z">2023-03-02</time></p><p class="title"><a href="/2023/03/02/bloom-zh/">【語言模型】繁中語言模型 bloom-1b1-zh 試玩</a></p><p class="categories"><a href="/categories/AI/">AI</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-02-27T16:00:00.000Z">2023-02-28</time></p><p class="title"><a href="/2023/02/28/ubuntu-kernel-version/">【資安小知識】Linux Kernel 出漏洞 Ubuntu 該升級哪一版?</a></p><p class="categories"><a href="/categories/%E8%B3%87%E5%AE%89/">資安</a> / <a href="/categories/%E8%B3%87%E5%AE%89/%E9%9B%9C%E8%AB%87/">雜談</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">October 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/09/"><span class="level-start"><span class="level-item">September 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/08/"><span class="level-start"><span class="level-item">August 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">March 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">February 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/12/"><span class="level-start"><span class="level-item">December 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">November 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/01/"><span class="level-start"><span class="level-item">January 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">September 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/08/"><span class="level-start"><span class="level-item">August 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/GIL/"><span class="tag">GIL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RSA/"><span class="tag">RSA</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/adb/"><span class="tag">adb</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ai/"><span class="tag">ai</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">android</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blockchain/"><span class="tag">blockchain</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bloom/"><span class="tag">bloom</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/burp/"><span class="tag">burp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/c/"><span class="tag">c++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/chatgpt/"><span class="tag">chatgpt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/command/"><span class="tag">command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crypto/"><span class="tag">crypto</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ctf/"><span class="tag">ctf</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cve/"><span class="tag">cve</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dapper-labs/"><span class="tag">dapper labs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/drony/"><span class="tag">drony</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flare/"><span class="tag">flare</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flare-on/"><span class="tag">flare-on</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flow/"><span class="tag">flow</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/frida/"><span class="tag">frida</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gdb/"><span class="tag">gdb</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hitcon/"><span class="tag">hitcon</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/icarus/"><span class="tag">icarus</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kernel/"><span class="tag">kernel</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/llm/"><span class="tag">llm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nord/"><span class="tag">nord</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nox/"><span class="tag">nox</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/osint/"><span class="tag">osint</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pe/"><span class="tag">pe</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/powerlevel10k/"><span class="tag">powerlevel10k</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/powerlevel9k/"><span class="tag">powerlevel9k</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/powershell/"><span class="tag">powershell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/proxy/"><span class="tag">proxy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pyc/"><span class="tag">pyc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reverse/"><span class="tag">reverse</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reverse-engineering/"><span class="tag">reverse engineering</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reverse-ssh/"><span class="tag">reverse ssh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rootkit/"><span class="tag">rootkit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rsa/"><span class="tag">rsa</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/security/"><span class="tag">security</span><span class="tag">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/seo/"><span class="tag">seo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/srop/"><span class="tag">srop</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">ssh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tunnel/"><span class="tag">tunnel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ubuntu/"><span class="tag">ubuntu</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/windows/"><span class="tag">windows</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/writeups/"><span class="tag">writeups</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/zimfw/"><span class="tag">zimfw</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/zsh/"><span class="tag">zsh</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">歐欸利恩的部落格</a><p class="is-size-7"><span>&copy; 2024 oalieno</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/oalieno"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js" integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>